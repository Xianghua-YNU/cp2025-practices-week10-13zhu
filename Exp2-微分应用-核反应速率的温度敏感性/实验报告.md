# 3-α 反应速率的温度敏感性指数计算实验报告
## 一、实验目的
1. 理解3-α反应速率对温度的依赖性
2. 掌握数值微分方法（有限差分）计算温度敏感性指数的原理和实现
3. 分析不同温度下反应速率的敏感性特征及其物理意义
## 二、实验原理
### 2.1 3-α反应速率
3-α反应是一个重要的核聚变过程，将三个氦-4原子核聚变成一个碳-12原子核：

$${}^4\mathrm{He} + {}^4\mathrm{He} + {}^4\mathrm{He} \rightarrow {}^{12}\mathrm{C}$$

其能量产生率表达式为：

$$q_{3\alpha} = 5.09\times 10^{11} \rho^2 Y^3 T_8^{-3} e^{-44.027/T_8} \mathrm{erg g^{-1}~s^{-1}}$$

### 2.2 温度敏感性指数
温度敏感性指数 $\nu$ 定义为反应速率对数对温度对数的导数：

$$\nu = \left . \frac{d\log q}{d\log T}\right | _{T_0} = \left ( \frac{T}{q} \frac{dq}{dT} \right ) _{T_0}$$

使用前向差分法近似计算导数：

$$\nu(T_0) \approx \frac{T_0}{q(T_0)} \frac{q(T_0 + h \cdot T_0) - q(T_0)}{h \cdot T_0}$$

## 三、代码实现
（此处粘贴您实现的代码，包括反应速率函数和温度敏感性指数计算函数）

```python
# 在此处粘贴您的代码实现
```
import math
import matplotlib.pyplot as plt
import numpy as np


def reaction_rate(T):
    """
    编写一个函数，输入参数温度 T (单位 K)，返回 3-α 反应速率中与温度相关的部分 q_3a / (ρ²γ³)
    即计算: f(T) = 5.09×10¹¹T₈⁻³ e⁻⁴⁴.⁰²⁷/T₈，其中 T₈ = T / 10⁸。
    """
    T8 = T / 1e8
    return 5.09 * (10 ** 11) * (T8 ** (-3)) * math.exp(-44.027 / T8)


def temperature_sensitivity(T0, h=1e-8):
    """
    根据 v 的定义 v = (T/q) * (dq/dT)，使用数值微分（向前差分法）来近似导数 dq/dT
    选择一个合适的微小温度扰动 ΔT。为了平衡截断误差和舍入误差，一个常见的选择是 ΔT = h * T0，其中 h 是一个很小的数，例如 h = 10⁻⁸。
    将近似导数代入 v 的公式。
    """
    dT = h * T0
    q_T0 = reaction_rate(T0)
    q_T0_plus_dT = reaction_rate(T0 + dT)
    dq_dT = (q_T0_plus_dT - q_T0) / dT
    return (T0 / q_T0) * dq_dT


# 任务3
reference_temperatures = [1.0e8, 2.5e8, 5.0e8, 1.0e9, 2.5e9, 5.0e9]
for T0 in reference_temperatures:
    v = temperature_sensitivity(T0)
    print(f"温度: {T0} K, v值: {v}")

# 任务4
# 生成温度范围
T = np.logspace(8, 9, 100)  # 从10^8 到 10^9 取100个点
q_values = [reaction_rate(t) for t in T]

# 绘制对数-对数坐标图
plt.loglog(T, q_values)
plt.xlabel('温度 T (K)')
plt.ylabel('q_3a / (ρ²γ³)')
plt.title('反应速率与温度的关系')
plt.show()




## 四、实验结果与分析
### 4.1 温度敏感性指数计算结果

| 温度 T (K) | ν 值 |
|------------|------|
| 1.0e8      | 41.02700772689061     |
| 2.5e8      |   14.610801024907273   |
| 5.0e8      |  5.805400153990041    |
| 1.0e9      |  1.4027000231144235    |
| 2.5e9      |  -1.2389199937176567    |
| 5.0e9      |    -2.119459967615161  |

### 4.2 反应速率随温度变化的可视化分析
（在此处插入您绘制的反应速率随温度变化的对数-对数图，并进行分析说明）
![image](https://github.com/user-attachments/assets/cbf4fef5-6168-42ef-a061-d96c9385a1bf)

### 4.3 结果分析
1. 温度敏感性随温度变化的趋势分析：
   
   - 在低温区域（~10⁸ K）的敏感性特征
   - 在低温区域，物质内部分子/粒子热运动相对较弱，体系处于较稳定的低能状态。温度敏感性通常较低，即系统物理性质（如反应速率、材料性能等）随温度变化的幅度较小。此时，温度对体系的影响主要表现为缓慢激活低能态的微观过程，敏感性曲线斜率较小，变化趋势平缓。
   - 在高温区域（~10⁹ K）的敏感性特性
   - 高温区域中，粒子热运动剧烈，体系能量高且微观状态活跃。温度敏感性显著增强，物理性质对温度变化的响应更剧烈。例如，高温下化学反应速率可能呈指数级增长，材料相变或分解过程对温度波动更敏感，敏感性曲线斜率明显增大，变化趋势陡峭。
   - 敏感性指数的变化趋势及其物理意义
   - 敏感性指数随温度升高通常呈递增趋势，反映系统对温度扰动的响应能力逐渐增强。其物理意义在于：指数越高，表明温度微小变化对系统状态（如反应进程、材料性能演化等）的影响越显著，可用于表征系统在不同温度下的稳定性或反应活性——低温下系统稳定性高，高温下稳定性低但活性高。
2. 数值计算方法的精度分析：

   - 步长选择（h = 10⁻⁸）的合理性
步长较小，可有效降低截断误差，提高数值解对连续问题的逼近精度，适用于对精度要求较高的场景（如强非线性变化区域）。
   - 可能的数值误差来源及其影响
   - - 截断误差：由数值方法对微分方程的离散近似引起（如欧拉法、有限差分法的泰勒展开截断）。步长h越小，截断误差理论上越低，但无法完全消除，影响解的整体精度。
 
- 舍入误差：计算机有限精度运算导致（如浮点数存储精度限制）。步长小则计算步数多，舍入误差累积效应可能放大，尤其在长时间或多步迭代计算中，可能显著偏离真实解。
 
- 算法稳定性误差：部分数值方法（如显式算法）存在稳定性条件，若步长不满足（如超过临界值），解可能发散。需结合具体算法（如检查稳定性条件）评估h = 10⁻⁸是否导致不稳定。
 
## 五、讨论与思考
1. 为什么在低温（T₀ = 10⁸ K）时 $\nu$值特别大？这对恒星演化有什么意义？
- 原因：低温下，恒星内部物质的不透明度（\nu）主要由束缚-束缚跃迁、束缚-自由跃迁（如 {\rm H}^- 离子吸收）主导。此时原子电离度低，更多束缚态电子参与辐射吸收，导致不透明度显著增大。
 
- 对恒星演化的意义：高不透明度会阻碍能量传输，使恒星内部热量积累，可能推动对流区扩展。例如，主序星演化后期，不透明度变化影响恒星结构，驱动对流主导的能量传输模式，进而影响恒星的膨胀、收缩及元素混合过程。

2.  数值微分中步长的选择（h = 10⁻⁸）是如何平衡截断误差和舍入误差的？
选择 h = 10^{-8} 时，需使截断误差与舍入误差的总和最小。此时 h 已足够小，截断误差占主导地位且被控制在较低水平，同时避免因 h 过小导致舍入误差急剧增长，达到两者的优化平衡。
 
3.   如果使用中心差分法替代前向差分法，计算结果会有什么不同？精度会如何改变？
- 精度差异：前向差分法为一阶精度（误差 O**)），中心差分法为二阶精度（误差 O**^2)）。
 
- 计算结果：中心差分法通过对称采样（f(x+h) 和 f(x-h)）抵消一阶误差项，对光滑函数的导数计算更接近真实值，误差更小。例如，计算 f(x) = x^2 的导数时，中心差分结果更逼近理论值 2x，而前向差分存在明显偏差。
4. 反应速率对温度的强依赖性对恒星内部的温度调节机制有什么影响
- 负反馈调节：恒星核反应（如氢聚变为氦）速率对温度敏感（满足 r \propto T^\alpha，\alpha \gg 1）。若温度轻微升高，反应速率剧增，产热增加，推动恒星膨胀，温度降低；反之，温度降低时反应速率骤减，恒星收缩升温。这种强依赖性形成负反馈机制，维持恒星内部温度稳定，确保演化过程中能量产出与辐射损失的动态平衡。
## 六、结论
（总结实验的主要发现和结论）
